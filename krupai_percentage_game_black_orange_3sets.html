<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Kru Pai • Percentage Game — 3 ชุด (ง่าย/กลาง/ยาก) โทนดำ–ส้ม</title>
<style>
  :root {
    --bg: #0b0f14;        /* ดำเข้ม */
    --card: #111720;      /* กล่องเข้ม */
    --ink: #e5e7eb;       /* ตัวอักษรอ่อน */
    --muted: #9aa4b2;
    --accent: #ff6f00;    /* ส้ม */
    --accent2:#ffaa33;
    --ok:#22c55e;
    --bad:#ef4444;
    --border:#1f2733;
  }
  * { box-sizing:border-box; }
  html, body { margin:0; background:var(--bg); color:var(--ink); font-family:'Segoe UI', system-ui, -apple-system, Tahoma, sans-serif; }
  .wrap { max-width: 980px; margin: 28px auto; padding: 0 16px 64px; }
  header { display:flex; gap:14px; align-items:center; flex-wrap:wrap; margin-bottom: 10px; }
  .logo { width:64px; height:64px; border-radius:18px; display:grid; place-items:center; color:#0b0f14; font-weight:900; background: linear-gradient(145deg, var(--accent), var(--accent2)); box-shadow:0 10px 24px rgba(255,111,0,.2); }
  h1 { margin:0; font-size:clamp(24px,3.6vw,40px); }
  .subtitle { color:var(--muted); }
  .watermark { color:var(--accent2); font-weight:800; }
  .card { background:var(--card); border:1px solid var(--border); border-radius:18px; padding:18px; box-shadow:0 10px 28px rgba(0,0,0,.25); }
  .controls { margin: 14px 0 20px; display:flex; gap:10px; flex-wrap:wrap; }
  button { border:0; border-radius:12px; padding:11px 16px; cursor:pointer; color:#0b0f14; background:var(--accent); font-weight:700; font-size:16px; box-shadow:0 8px 18px rgba(255,111,0,.25); }
  button.secondary { background:#222b36; color:var(--ink); box-shadow:none; border:1px solid var(--border); }
  input[type="text"], input[type="number"] { background:#0c121a; color:var(--ink); border:1.5px solid var(--border); border-radius:12px; padding:10px 12px; font-size:16px; }
  .qcard { background:#0c121a; border:1px solid var(--border); border-radius:14px; padding:12px 14px; margin-top:8px; }
  .inputs { display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; align-items:center; }
  .result { margin-left:8px; font-weight:800; }
  .ok { color:var(--ok); }
  .bad { color:var(--bad); }
  .hint { color:var(--muted); font-size:14px; margin-top:4px; }
  .grid { display:grid; gap:14px; }
  .grid-2 { grid-template-columns: 1fr; }
  @media (min-width: 900px) { .grid-2 { grid-template-columns: 1fr 1fr; } }
  .hidden { display:none !important; }
  footer { margin-top: 28px; color: var(--muted); font-size: 14px; }
  .titlebar { display:flex; align-items:center; justify-content:space-between; gap:12px; margin:10px 0 14px; }
  .pill { background:#18202b; border:1px solid var(--border); color:var(--ink); padding:6px 10px; border-radius:999px; font-size:13px; }
  .scorebox { font-size: clamp(22px, 3vw, 28px); font-weight:900; color:var(--accent2); }
  .summary-card { text-align:center; padding:24px; }
  .name-big { font-size: clamp(22px,3.5vw,30px); font-weight:900; color:#fff; }
  .big-score { font-size: clamp(40px,6vw,72px); font-weight:900; color:var(--ok); margin: 8px 0; }
  .share-note { color:var(--muted); }
  .set-selector button { background:#222b36; color:var(--ink); border:1px solid var(--border); }
  .set-selector button.active { background:var(--accent); color:#0b0f14; }
</style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">KP</div>
      <div>
        <h1>Kru Pai • Percentage Game — 3 ชุด (ง่าย/กลาง/ยาก)</h1>
        <div class="subtitle">อัปเดต 2025-09-14 04:56 • ลงชื่อ → เลือกชุด → ทำแบบฝึก → สรุปคะแนน</div>
        <div class="watermark">Kru Pai Classroom</div>
      </div>
    </header>

    <!-- START SCREEN -->
    <section id="screen-start" class="card">
      <h2>ลงชื่อก่อนเริ่มทำแบบฝึก</h2>
      <div class="grid grid-2">
        <div>
          <label>ชื่อเล่นนักเรียน</label><br/>
          <input id="studentName" type="text" placeholder="เช่น น้องพลอย / น้องกันต์">
        </div>
        <div>
          <label>ห้อง/ชั้น (ถ้ามี)</label><br/>
          <input id="studentClass" type="text" placeholder="เช่น ม.1/3">
        </div>
      </div>
      <div class="controls">
        <button onclick="startQuiz()">เริ่มทำแบบฝึก</button>
      </div>
      <div class="hint">* ระบบจะบันทึกชื่อไว้ในหน้านี้เท่านั้น (ไม่ส่งออกไปภายนอก)</div>
    </section>

    <!-- QUIZ SCREEN -->
    <section id="screen-quiz" class="card hidden">
      <div class="titlebar">
        <div class="pill">ผู้ทำแบบฝึก: <span id="who">-</span></div>
        <div class="scorebox">ถูก: <span id="score">0</span> / <span id="total">0</span></div>
      </div>

      <div class="set-selector controls">
        <button id="btn-set1" onclick="loadSet(1)" class="active">ชุดที่ 1: ง่าย (5 ข้อ)</button>
        <button id="btn-set2" onclick="loadSet(2)">ชุดที่ 2: กลาง (10 ข้อ)</button>
        <button id="btn-set3" onclick="loadSet(3)">ชุดที่ 3: ยาก (5 ข้อ)</button>
      </div>

      <ol id="quiz-list"></ol>

      <div class="controls">
        <button onclick="finishSet()">จบชุดนี้ &gt; ดูสรุปคะแนน</button>
        <button class="secondary" onclick="resetSet()">รีเซ็ตชุดนี้</button>
      </div>
    </section>

    <!-- SUMMARY SCREEN -->
    <section id="screen-summary" class="card hidden summary-card">
      <div class="pill">สรุปผล • แคปหน้าจอส่งครูได้เลย</div>
      <div class="name-big" id="sum-name">-</div>
      <div style="margin:6px 0 14px; color:var(--muted);" id="sum-class"></div>
      <div class="big-score"><span id="sum-correct">0</span> / <span id="sum-total">0</span></div>
      <div class="share-note" id="sum-note"></div>
      <div class="controls" style="justify-content:center;">
        <button onclick="window.print()">พิมพ์ / บันทึก PDF</button>
        <button class="secondary" onclick="backToQuiz()">กลับไปเลือกชุดถัดไป</button>
      </div>
    </section>

    <footer>© Kru Pai Classroom — Black &amp; Orange Edition • ไม่มีปุ่มดูเฉลย มีแต่ระบบตรวจคำตอบ ✅❌</footer>
  </div>

<script>
// --- ชุดโจทย์ ---
const set1_easy = [
  { q:"20% ของ 50 เท่ากับเท่าไร?", a:["10"], unit:"จำนวน" },
  { q:"25% ของ 200 เท่ากับเท่าไร?", a:["50"], unit:"จำนวน" },
  { q:"10% ของ 80 เท่ากับเท่าไร?", a:["8"], unit:"จำนวน" },
  { q:"50% ของ 36 เท่ากับเท่าไร?", a:["18"], unit:"จำนวน" },
  { q:"75% ของ 120 เท่ากับเท่าไร?", a:["90"], unit:"จำนวน" },
];

const set2_medium = [
  { q:"หนังสือราคา 200 บาท ลดราคา 15% ต้องจ่ายกี่บาท?", a:["170"], unit:"บาท" },
  { q:"สินค้าราคา 500 บาท ลดราคา 20% จะเหลือกี่บาท?", a:["400"], unit:"บาท" },
  { q:"เงินฝาก 2,000 บาท ได้ดอกเบี้ย 5% ต่อปี จะได้ดอกเบี้ยกี่บาทใน 1 ปี?", a:["100"], unit:"บาท" },
  { q:"นักเรียน 400 คน เป็นนักเรียนหญิง 60% มีนักเรียนหญิงกี่คน?", a:["240"], unit:"คน" },
  { q:"นักเรียนได้ 72 คะแนน จากเต็ม 100 เท่ากับกี่เปอร์เซ็นต์?", a:["72"], unit:"เปอร์เซ็นต์" },
  { q:"ข้าวสาร 50 กก. ใช้ไป 30% จะเหลือกี่กิโลกรัม?", a:["35"], unit:"กิโลกรัม" },
  { q:"เสื้อราคา 300 บาท เพิ่มราคา 10% จะเป็นราคาใหม่เท่าไร?", a:["330"], unit:"บาท" },
  { q:"น้ำหนักเพิ่มจาก 40 กก. เป็น 50 กก. เพิ่มขึ้นกี่เปอร์เซ็นต์?", a:["25"], unit:"เปอร์เซ็นต์" },
  { q:"ซื้อปากกา 20 ด้าม เสียไป 4 ด้าม คิดเป็นกี่เปอร์เซ็นต์ของทั้งหมด?", a:["20"], unit:"เปอร์เซ็นต์" },
  { q:"ทางยาว 240 กม. วิ่งไปแล้ว 75% เหลืออีกกี่กิโลเมตร?", a:["60"], unit:"กิโลเมตร" }
];

const set3_hard = [
  { q:"สินค้าราคา 1,000 บาท ลด 20% แล้วลดเพิ่มอีก 10% จะเหลือราคาเท่าไร?", a:["720"], unit:"บาท" },
  { q:"นักเรียน 50 คน สอบผ่าน 80% จากนั้นสอบซ่อมผ่านเพิ่มอีก 20% ของจำนวนที่ยังไม่ผ่าน จะมีนักเรียนผ่านทั้งหมดกี่คน?", a:["42"], unit:"คน" },
  { q:"เงินลงทุน 12,000 บาท เพิ่มขึ้น 25% แล้วลดลง 10% จะเหลือเท่าไร?", a:["13500"], unit:"บาท" },
  { q:"ยอดขายเดือนนี้ 360 กก. ซึ่งเพิ่มขึ้น 20% จากเดือนก่อน เดือนก่อนขายได้กี่กิโลกรัม?", a:["300"], unit:"กิโลกรัม" },
  { q:"ครูปายมีสมุด 120 เล่ม แจกไป 25% แล้วแจกเพิ่มอีก 20% ของที่เหลือ ครูปายแจกสมุดไปทั้งหมดกี่เล่ม?", a:["48"], unit:"เล่ม" }
];

const SETS = {1:set1_easy, 2:set2_medium, 3:set3_hard};

let currentSet = 1;
let score = 0;
let total = 0;
const state = {}; // เก็บถูก/ผิดของแต่ละข้อในชุดปัจจุบัน

document.addEventListener('DOMContentLoaded', () => {
  loadSet(1);
});

function startQuiz() {
  const name = (document.getElementById('studentName').value || '').trim();
  const room = (document.getElementById('studentClass').value || '').trim();
  if (!name) { alert('กรอกชื่อเล่นก่อนนะ'); return; }
  document.getElementById('who').textContent = name + (room ? ' • ' + room : '');
  document.getElementById('screen-start').classList.add('hidden');
  document.getElementById('screen-quiz').classList.remove('hidden');
  window.scrollTo(0,0);
}

function loadSet(n) {
  currentSet = n;
  score = 0;
  for (const k in state) delete state[k];

  const list = document.getElementById('quiz-list');
  list.innerHTML = '';

  const problems = SETS[n];
  total = problems.length;
  document.getElementById('score').textContent = 0;
  document.getElementById('total').textContent = total;

  // ปุ่ม active
  ['btn-set1','btn-set2','btn-set3'].forEach(id => document.getElementById(id).classList.remove('active'));
  document.getElementById('btn-set'+n).classList.add('active');

  problems.forEach((p, idx) => {
    const li = document.createElement('li');
    const id = `SET${n}-${idx+1}`;
    li.innerHTML = `
      ${p.q}
      <div class="qcard">
        <div class="hint">หน่วย: ${p.unit}</div>
        <div class="inputs" data-id="${id}" data-ans="${p.a.join('|')}">
          ${p.a.map(() => '<input type="number" placeholder="กรอกคำตอบ">').join('')}
          <button onclick="check(this)">ตรวจ</button>
          <span class="result"></span>
        </div>
      </div>`;
    list.appendChild(li);
  });
}

function parseNum(v) { if(v===''||v===null||v===undefined) return null; return Number(v); }

function check(btn) {
  const box = btn.closest('.inputs');
  const ans = box.dataset.ans.split('|').map(Number);
  const id = box.dataset.id;
  const inputs = Array.from(box.querySelectorAll('input[type=number]'));
  const got = inputs.map(i => parseNum(i.value));
  const res = box.querySelector('.result');

  if (got.some(v => v===null || Number.isNaN(v))) {
    res.textContent = 'กรอกให้ครบก่อนนะ';
    res.className = 'result bad';
    return;
  }

  let ok = true;
  for (let i=0;i<ans.length;i++) { if (got[i] !== ans[i]) { ok = false; break; } }
  if (ok) {
    if (!state[id]) { state[id] = true; score++; document.getElementById('score').textContent = score; }
    res.textContent = 'ถูกต้องจ้า ✅';
    res.className = 'result ok';
    inputs.forEach(i => i.disabled = true);
    btn.disabled = true;
  } else {
    state[id] = false;
    res.textContent = 'ยังไม่ถูก ลองใหม่ ❌';
    res.className = 'result bad';
  }
}

function finishSet() {
  const name = (document.getElementById('studentName').value || '').trim();
  const room = (document.getElementById('studentClass').value || '').trim();
  document.getElementById('sum-name').textContent = name || '-';
  document.getElementById('sum-class').textContent = room ? ('ชั้น/ห้อง: ' + room) : '';
  document.getElementById('sum-correct').textContent = score;
  document.getElementById('sum-total').textContent = total;

  let note = '';
  if (currentSet === 1) note = 'เกณฑ์ผ่านแนะนำ: ≥ 4/5';
  if (currentSet === 2) note = 'เกณฑ์ผ่านแนะนำ: ≥ 8/10';
  if (currentSet === 3) note = 'เกณฑ์ผ่านแนะนำ: ≥ 4/5';
  document.getElementById('sum-note').textContent = note;

  // ไปหน้า summary
  document.getElementById('screen-quiz').classList.add('hidden');
  document.getElementById('screen-summary').classList.remove('hidden');
  window.scrollTo(0,0);
}

function backToQuiz() {
  document.getElementById('screen-summary').classList.add('hidden');
  document.getElementById('screen-quiz').classList.remove('hidden');
  window.scrollTo(0,0);
}

function resetSet() {
  score = 0;
  for (const k in state) delete state[k];
  document.getElementById('score').textContent = 0;
  document.querySelectorAll('#quiz-list input[type=number]').forEach(i=>{ i.value=''; i.disabled=false; });
  document.querySelectorAll('#quiz-list .result').forEach(r=>{ r.textContent=''; r.className='result'; });
  document.querySelectorAll('#quiz-list .inputs button').forEach(b=> b.disabled=false);
}
</script>
</body>
</html>
